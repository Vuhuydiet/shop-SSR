<div class="container mx-auto px-4 py-8">
  <!-- Header -->
  <div class="flex justify-between items-center mb-4 mt-6">
    <h1 class="text-2xl font-bold">My Orders</h1>

    <!-- Filters -->
    <div class="flex gap-4">
      <select name="status" class="form-select">
        <option value="">All Status</option>
        <option value="PENDING">Pending</option>
        <option value="CONFIRMED">Confirmed</option>
        <option value="SHIPPING">Shipping</option>
        <option value="DELIVERED">Delivered</option>
        <option value="CANCELLED">Cancelled</option>
        <option value="PAID">Paid</option>
      </select>

      <input
        type="date"
        name="startDate"
        class="form-input"
        placeholder="From Date"
      />
      <input
        type="date"
        name="endDate"
        class="form-input"
        placeholder="To Date"
      />
    </div>
  </div>

  <!-- Orders Table -->
  <div class="bg-white rounded-lg shadow overflow-hidden w-full">
    <table class="w-full divide-y divide-gray-200">
      <thead class="bg-gray-50">
        <tr>
          <th
            class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"
          >
            Order ID
          </th>
          <th
            class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"
          >
            Date
          </th>
          <th
            class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"
          >
            Status
          </th>
          <th
            class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"
          >
            Total
          </th>
          <th
            class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"
          >
            Payment
          </th>
          <th
            class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"
          >
            Actions
          </th>
        </tr>
      </thead>
      <tbody class="bg-white divide-y divide-gray-200">
        <% orders.forEach(order => { %>
        <tr class="hover:bg-gray-50">
          <td class="px-6 py-4 whitespace-nowrap">
            <div class="text-sm font-medium text-gray-900">
              #<%= order.orderId %>
            </div>
          </td>
          <td class="px-6 py-4 whitespace-nowrap">
            <div class="text-sm text-gray-900">
              <%= new Date(order.createdAt).toLocaleDateString() %>
            </div>
            <div class="text-sm text-gray-500">
              <%= new Date(order.createdAt).toLocaleTimeString() %>
            </div>
          </td>
          <td class="px-6 py-4 whitespace-nowrap">
            <span
              class="px-2 inline-flex text-xs leading-5 font-semibold rounded-full <%= order.orderStatus === 'PENDING' ? 'bg-yellow-100 text-yellow-800' : '' %> <%= order.orderStatus === 'CONFIRMED' ? 'bg-blue-100 text-blue-800' : '' %> <%= order.orderStatus === 'SHIPPING' ? 'bg-indigo-100 text-indigo-800' : '' %> <%= order.orderStatus === 'DELIVERED' ? 'bg-green-100 text-green-800' : '' %> <%= order.orderStatus === 'CANCELLED' ? 'bg-red-100 text-red-800' : '' %> <%= order.orderStatus === 'PAID' ? 'bg-purple-100 text-purple-800' : '' %>"
            >
              <%= order.orderStatus %>
            </span>
          </td>
          <td class="px-6 py-4 whitespace-nowrap">
            <div class="text-sm font-medium text-gray-900">
              $<%= order.totalAmount.toFixed(2) %>
            </div>
          </td>
          <td class="px-6 py-4 whitespace-nowrap">
            <div class="text-sm text-gray-900"><%= order.paymentMethod %></div>
          </td>
          <td
            class="px-6 py-4 whitespace-nowrap text-right text-sm font-medium"
          >
            <!-- Actions based on status -->
            <div class="flex gap-2">
              <a
                href="/orders/<%= order.orderId %>"
                class="text-indigo-600 hover:text-indigo-900"
                >View</a
              >
              <% if (order.orderStatus === 'PENDING') { %>
              <form
                action="/orders/<%= order.orderId %>/cancel"
                method="POST"
                class="inline"
              >
                <button type="submit" class="text-red-600 hover:text-red-900">
                  Cancel
                </button>
              </form>
              <% } %>
            </div>
          </td>
        </tr>
        <!-- Expandable Details -->
        <tr class="bg-gray-50">
          <td colspan="6" class="px-6 py-4">
            <div class="text-sm text-gray-500">
              <strong>Shipping Address:</strong>
              <%= order.addressDetail %>, <%= order.ward %>, <%= order.district
              %>, <%= order.city %>, <%= order.country %> <% if
              (order.phoneNumber) { %> | <strong>Phone:</strong> <%=
              order.phoneNumber %> <% } %>
            </div>
          </td>
        </tr>
        <% }) %>
      </tbody>
    </table>
  </div>

  <!-- Pagination -->
  <div class="mt-4 flex items-center justify-between">
    <div class="flex-1 flex justify-between sm:hidden">
      <% if (currentPage > 1) { %>
      <a href="?page=<%= currentPage - 1 %>" class="btn-primary">Previous</a>
      <% } %> <% if (currentPage < totalPages) { %>
      <a href="?page=<%= currentPage + 1 %>" class="btn-primary">Next</a>
      <% } %>
    </div>
    <div class="hidden sm:flex-1 sm:flex sm:items-center sm:justify-between">
      <div>
        <p class="text-sm text-gray-700">
          Showing page <span class="font-medium"><%= currentPage %></span> of
          <span class="font-medium"><%= totalPages %></span>
        </p>
      </div>
      <div>
        <nav class="relative z-0 inline-flex rounded-md shadow-sm -space-x-px">
          <% for(let i = 1; i <= totalPages; i++) { %>
          <a
            href="?page=<%= i %>"
            class="relative inline-flex items-center px-4 py-2 border text-sm font-medium <%= currentPage === i ? 'bg-indigo-50 border-indigo-500 text-indigo-600' : 'bg-white text-gray-500 hover:bg-gray-50' %>"
          >
            <%= i %>
          </a>
          <% } %>
        </nav>
      </div>
    </div>
  </div>
</div>
